import{H as M,A as $}from"./header-ce1ba502.js";import{F as O}from"./footer-0b848f08.js";import{d as G,l as J}from"./thing-6c3202c7.js";import{l as K,c as P,a as Q}from"./comment-3feac44b.js";import{w as X}from"./thingWish-0327c2dd.js";import{c as Y}from"./thingCollect-d0e1be9b.js";import{u as Z,y as ss,a as ts,z as a,j as es,B as T,m as h,o as d,e as r,k as U,f as s,g as o,t as i,F as C,l as y,q as os,n as m,x as ns,p as is,h as cs}from"./index-f6b5f6b4.js";import{g as ls}from"./index-14399c2b.js";import{_ as as}from"./_plugin-vue_export-helper-c27b6911.js";import"./notice-502f1323.js";import"./k-logo-98944f67.js";const ds=""+new URL("add-5fe2b74b.svg",import.meta.url).href,rs=""+new URL("want-read-hover-e9e227e2.svg",import.meta.url).href,_s=""+new URL("recommend-hover-69a5cc0c.svg",import.meta.url).href,hs=""+new URL("share-icon-d2ff6534.svg",import.meta.url).href,us=""+new URL("wb-share-28941437.svg",import.meta.url).href;const c=v=>(is("data-v-46e2e5bb"),v=v(),cs(),v),ms={class:"detail"},vs={class:"detail-content"},ps={class:"detail-content-top"},gs={style:{position:"relative"}},fs={class:"thing-infos-view"},bs={class:"thing-infos"},xs={class:"thing-img-box"},ws=["src"],ks={class:"thing-info-box"},Is=c(()=>s("div",{class:"thing-state"},[s("span",{class:"state hidden-sm"},"商品状态"),s("span",null,"上市销售")],-1)),Cs={class:"thing-name"},ys=c(()=>s("span",{class:"a-price-symbol"},"¥",-1)),Rs={class:"a-price"},As={class:"translators flex-view",style:{}},Ls=c(()=>s("span",null,"分类：",-1)),Ss={class:"name"},$s={class:"translators flex-view",style:{}},Ts=c(()=>s("span",null,"库存：",-1)),Us={class:"name"},Bs=["src"],Fs=c(()=>s("span",null,"立即购买",-1)),qs={class:"thing-counts hidden-sm"},Es={class:"count-img"},zs=["src"],Ds={class:"count-box flex-view"},Hs=c(()=>s("div",{class:"count-text-box"},[s("span",{class:"count-title"},"加入心愿单")],-1)),Ns={class:"count-num-box"},Vs={class:"num-text"},Ws={class:"count-img"},js=["src"],Ms={class:"count-box flex-view"},Os=c(()=>s("div",{class:"count-text-box"},[s("span",{class:"count-title"},"收藏")],-1)),Gs={class:"count-num-box"},Js={class:"num-text"},Ks={class:"count-img"},Ps=["src"],Qs={class:"count-box flex-view"},Xs=c(()=>s("div",{class:"count-text-box"},[s("span",{class:"count-title"},"分享")],-1)),Ys={class:"count-num-box"},Zs=c(()=>s("span",{class:"num-text"},null,-1)),st=["src"],tt={class:"detail-content-bottom"},et={class:"thing-content-view flex-view"},ot={class:"main-content"},nt={class:"order-view main-tab"},it=["onClick"],ct={class:"text",style:{}},lt=c(()=>s("div",{class:"title"},"发表新的评论",-1)),at={class:"publish flex-view"},dt=["src"],rt={class:"tab-view flex-view"},_t={class:"count-text"},ht={key:0,class:"tab-box flex-view"},ut=c(()=>s("div",{class:"line"},null,-1)),mt={class:"comments-list"},vt={class:"comment-item"},pt={class:"flex-item flex-view"},gt=["src"],ft={class:"person"},bt={class:"name"},xt={class:"time"},wt={class:"float-right"},kt=["onClick"],It={class:"num"},Ct={class:"comment-content"},yt=c(()=>s("div",{class:"infinite-loading-container"},[s("div",{class:"infinite-status-prompt",style:{}},[s("div",{slot:"no-results",class:"no-results"},[s("div"),s("p",null,"没有更多了")])])],-1)),Rt={class:"recommend",style:{}},At=c(()=>s("div",{class:"title"},"热门推荐",-1)),Lt={class:"things"},St=["onClick"],$t={class:"img-view"},Tt=["src"],Ut={class:"info-view"},Bt={class:"thing-name"},Ft=c(()=>s("span",{class:"a-price-symbol"},"¥",-1)),qt={class:"a-price"},Et={__name:"detail",setup(v){const k=Z(),B=ss(),p=ts();let _=a(""),l=a({}),R=a(6),F=a(["简介","评论"]),g=a(0),f=a([]),A=a([]),b=a(0),L=a("recent"),x=a();es(()=>{_.value=B.query.id.trim(),I(),N(),w()});const q=t=>{g.value=t,R.value=6+54*t},I=()=>{G({id:_.value}).then(t=>{l.value=t.data,l.value.cover=T+"/api/staticfiles/image/"+l.value.cover}).catch(t=>{h.error("获取详情失败")})},E=()=>{let t=p.user_id;t?X({thingId:_.value,userId:t}).then(e=>{h.success(e.msg),I()}).catch(e=>{console.log("操作失败")}):h.warn("请先登录")},z=()=>{let t=p.user_id;t?Y({thingId:_.value,userId:t}).then(e=>{h.success(e.msg),I()}).catch(e=>{console.log("收藏失败")}):h.warn("请先登录")},D=()=>{let e="http://service.weibo.com/share/share.php?title="+("分享一个非常好玩的网站 "+window.location.href);window.open(e)},H=t=>{console.log(t),p.user_id,k.push({name:"confirm",query:{id:t.id,title:t.title,cover:t.cover,price:t.price}})},N=()=>{J({sort:"recommend"}).then(t=>{t.data.forEach((e,n)=>{e.cover&&(e.cover=T+"/api/staticfiles/image/"+e.cover)}),console.log(t),A.value=t.data.slice(0,6)}).catch(t=>{console.log(t)})},V=t=>{let e=k.resolve({name:"detail",query:{id:t.id}});window.open(e.href,"_blank")},W=()=>{console.log(x.value);let t=x.value.value.trim();if(console.log(t),t.length<=0)return;x.value.value="";let e=p.user_id;e?P({content:t,thingId:_.value,userId:e}).then(n=>{w()}).catch(n=>{console.log(n)}):(h.warn("请先登录！"),k.push({name:"login"}))},j=t=>{Q({id:t}).then(e=>{w()}).catch(e=>{console.log(e)})},w=()=>{K({thingId:_.value,order:L.value}).then(t=>{t.data.forEach(e=>{e.commentTime=ls(e.commentTime,!0)}),f.value=t.data}).catch(t=>{console.log(t)})},S=t=>{t==="recent"?b.value=0:b.value=1,L.value=t,w()};return(t,e)=>(d(),r("div",ms,[U(M),s("div",vs,[s("div",ps,[s("div",gs,[s("div",fs,[s("div",bs,[s("div",xs,[s("img",{src:o(l).cover},null,8,ws)]),s("div",ks,[Is,s("h1",Cs,i(o(l).title),1),s("span",null,[ys,s("span",Rs,i(o(l).price),1)]),s("div",As,[Ls,s("span",Ss,i(o(l).classification_title),1)]),s("div",$s,[Ts,s("span",Us,i(o(l).repertory),1)]),s("button",{class:"buy-btn",onClick:e[0]||(e[0]=n=>H(o(l)))},[s("img",{src:o(ds)},null,8,Bs),Fs])])]),s("div",qs,[s("div",{class:"count-item flex-view pointer",onClick:e[1]||(e[1]=n=>E())},[s("div",Es,[s("img",{src:o(rs)},null,8,zs)]),s("div",Ds,[Hs,s("div",Ns,[s("span",Vs,i(o(l).wishCount),1)])])]),s("div",{class:"count-item flex-view pointer",onClick:e[2]||(e[2]=n=>z())},[s("div",Ws,[s("img",{src:o(_s)},null,8,js)]),s("div",Ms,[Os,s("div",Gs,[s("span",Js,i(o(l).collectCount),1)])])]),s("div",{class:"count-item flex-view",onClick:e[3]||(e[3]=n=>D())},[s("div",Ks,[s("img",{src:o(hs)},null,8,Ps)]),s("div",Qs,[Xs,s("div",Ys,[Zs,s("img",{src:o(us),class:"mg-l"},null,8,st)])])])])])])]),s("div",tt,[s("div",et,[s("div",ot,[s("div",nt,[(d(!0),r(C,null,y(o(F),(n,u)=>(d(),r("span",{class:m(["tab",o(g)===u?"tab-select":""]),key:u,onClick:zt=>q(u)},i(n),11,it))),128)),s("span",{style:os({left:o(R)+"px"}),class:"tab-underline"},null,4)]),s("div",{class:m(["thing-intro",o(g)<=0?"":"hide"])},[s("p",ct,i(o(l).description),1)],2),s("div",{class:m(["thing-comment",o(g)>0?"":"hide"])},[lt,s("div",at,[s("img",{src:o($),class:"mine-img"},null,8,dt),s("input",{placeholder:"说点什么...",class:"content-input",ref_key:"commentRef",ref:x},null,512),s("button",{class:"send-btn",onClick:e[4]||(e[4]=n=>W())},"发送")]),s("div",rt,[s("div",_t,"共有"+i(o(f).length)+"条评论",1),o(f).length>0?(d(),r("div",ht,[s("span",{class:m(o(b)===0?"tab-select":""),onClick:e[5]||(e[5]=n=>S("recent"))},"最新",2),ut,s("span",{class:m(o(b)===1?"tab-select":""),onClick:e[6]||(e[6]=n=>S("hot"))},"热门",2)])):ns("",!0)]),s("div",mt,[(d(!0),r(C,null,y(o(f),n=>(d(),r("div",vt,[s("div",pt,[s("img",{src:o($),class:"avator"},null,8,gt),s("div",ft,[s("div",bt,i(n.username),1),s("div",xt,i(n.commentTime),1)]),s("div",wt,[s("span",{onClick:u=>j(n.id)},"推荐",8,kt),s("span",It,i(n.likeCount),1)])]),s("p",Ct,i(n.content),1)]))),256)),yt])],2)]),s("div",Rt,[At,s("div",Lt,[(d(!0),r(C,null,y(o(A),n=>(d(),r("div",{class:"thing-item thing-item",onClick:u=>V(n)},[s("div",$t,[s("img",{src:n.cover},null,8,Tt)]),s("div",Ut,[s("h3",Bt,i(n.title.substring(0,12)),1),s("span",null,[Ft,s("span",qt,i(n.price),1)])])],8,St))),256))])])])])]),U(O)]))}},Pt=as(Et,[["__scopeId","data-v-46e2e5bb"]]);export{Pt as default};
