import{G as Q,H as k,d as W,b as u,z as h,j as X,B as Y,r as d,o as y,e as v,f as m,k as l,s,I as S,x as I,g as i,m as p,p as Z,h as ee}from"./index-f6b5f6b4.js";import{_ as te}from"./_plugin-vue_export-helper-c27b6911.js";const oe=async c=>Q({url:"/api/ad/list",params:c,data:{},headers:{}}),ae=async c=>k({url:"/api/ad/create",params:{},data:c,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),ne=async c=>k({url:"/api/ad/update",data:c,headers:{"Content-Type":"multipart/form-data;charset=utf-8"}}),R=async c=>k({url:"/api/ad/delete",params:c,headers:{}}),U=c=>(Z("data-v-0325c84c"),c=c(),ee(),c),le={class:"page-view"},se={class:"table-operations"},ie=["src"],ce={key:1},de=["onClick"],re=U(()=>m("a",{href:"#"},"删除",-1)),me=U(()=>m("p",{class:"ant-upload-text"}," 请选择要上传的横幅图片 ",-1)),pe=W({__name:"ad",setup(c){const z=u([{title:"序号",dataIndex:"index",key:"index",align:"center"},{title:"图片",dataIndex:"imageUrl",key:"imageUrl",align:"center"},{title:"跳转链接",dataIndex:"link",key:"link",align:"center"},{title:"操作",dataIndex:"action",key:"operation",align:"center",fixed:"right",width:140}]),A=e=>{const o=new Date().getTime().toString()+"."+e.type.substring(6),n=new File([e],o);return console.log(n),t.form.imageFile=n,!1};h([]);const a=u({list:[],loading:!1,currentAdminUserName:"",keyword:"",selectedRowKeys:[],pageSize:10,page:1}),t=u({visile:!1,editFlag:!1,title:"",form:{id:void 0,image:void 0,imageFile:void 0,imageUrl:void 0,link:void 0},rules:{link:[{required:!0,message:"请输入",trigger:"change"}]}}),f=h();X(()=>{_()});const _=()=>{a.loading=!0,oe({keyword:a.keyword}).then(e=>{a.loading=!1,console.log(e),e.data.forEach((o,n)=>{o.index=n+1,o.image&&(o.imageUrl=Y+"/api/staticfiles/image/"+o.image)}),a.list=e.data}).catch(e=>{a.loading=!1,console.log(e)})},K=h({onChange:(e,o)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",o),a.selectedRowKeys=e}}),B=()=>{w(),t.visile=!0,t.editFlag=!1,t.title="新增";for(const e in t.form)t.form[e]=void 0;t.form.image=void 0},N=e=>{w(),t.visile=!0,t.editFlag=!0,t.title="编辑";for(const o in t.form)t.form[o]=void 0;for(const o in e)t.form[o]=e[o];t.form.image=void 0},D=e=>{console.log("delete",e),R({ids:e.id}).then(o=>{_()}).catch(o=>{p.error(o.msg||"操作失败")})},T=()=>{if(console.log(a.selectedRowKeys),a.selectedRowKeys.length<=0){console.log("hello"),p.warn("请勾选删除项");return}R({ids:a.selectedRowKeys.join(",")}).then(e=>{p.success("删除成功"),a.selectedRowKeys=[],_()}).catch(e=>{p.error(e.msg||"操作失败")})},E=()=>{var e;(e=f.value)==null||e.validate().then(()=>{const o=new FormData;t.form.id&&o.append("id",t.form.id),t.form.link&&o.append("link",t.form.link),t.form.imageFile&&o.append("imageFile",t.form.imageFile),t.editFlag?ne(o).then(n=>{g(),_()}).catch(n=>{console.log(n),p.error(n.msg||"操作失败")}):ae(o).then(n=>{g(),_()}).catch(n=>{console.log(n),p.error(n.msg||"操作失败")})}).catch(o=>{console.log("不能为空")})},V=()=>{g()},w=()=>{var e;(e=f.value)==null||e.resetFields()},g=()=>{t.visile=!1};return(e,o)=>{const n=d("a-button"),$=d("a-space"),M=d("a-divider"),j=d("a-popconfirm"),L=d("a-table"),O=d("a-upload-dragger"),x=d("a-form-item"),C=d("a-col"),q=d("a-input"),G=d("a-row"),H=d("a-form"),J=d("a-modal");return y(),v("div",null,[m("div",le,[m("div",se,[l($,null,{default:s(()=>[l(n,{type:"primary",onClick:B},{default:s(()=>[S("新增")]),_:1}),l(n,{onClick:T},{default:s(()=>[S("批量删除")]),_:1})]),_:1})]),l(L,{size:"middle",rowKey:"id",loading:i(a).loading,columns:i(z),"data-source":i(a).list,scroll:{x:"max-content"},"row-selection":i(K),pagination:{size:"default",current:i(a).page,pageSize:i(a).pageSize,onChange:r=>i(a).page=r,showSizeChanger:!1,showTotal:r=>`共${r}条数据`}},{bodyCell:s(({text:r,record:b,index:_e,column:F})=>[F.key==="imageUrl"?(y(),v("img",{key:0,src:r,style:{width:"60px",height:"40px"}},null,8,ie)):I("",!0),F.key==="operation"?(y(),v("span",ce,[m("a",{onClick:P=>N(b)},"编辑",8,de),l(M,{type:"vertical"}),l(j,{title:"确定删除?","ok-text":"是","cancel-text":"否",onConfirm:P=>D(b)},{default:s(()=>[re]),_:2},1032,["onConfirm"])])):I("",!0)]),_:1},8,["loading","columns","data-source","row-selection","pagination"])]),m("div",null,[l(J,{visible:i(t).visile,forceRender:!0,title:i(t).title,"ok-text":"确认","cancel-text":"取消",onCancel:V,onOk:E},{default:s(()=>[m("div",null,[l(H,{ref_key:"myform",ref:f,"label-col":{style:{width:"80px"}},model:i(t).form,rules:i(t).rules},{default:s(()=>[l(G,{gutter:24},{default:s(()=>[l(C,{span:"24"},{default:s(()=>[l(x,{label:"横幅图片"},{default:s(()=>[l(O,{name:"file",accept:"image/*",multiple:!1,"before-upload":A},{default:s(()=>[me]),_:1})]),_:1})]),_:1}),l(C,{span:"24"},{default:s(()=>[l(x,{label:"跳转链接",name:"link"},{default:s(()=>[l(q,{placeholder:"请输入",value:i(t).form.link,"onUpdate:value":o[0]||(o[0]=r=>i(t).form.link=r)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["visible","title"])])])}}});const ue=te(pe,[["__scopeId","data-v-0325c84c"]]);export{ue as default};
