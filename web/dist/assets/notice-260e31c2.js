import{l as G,d as x,u as H,c as J}from"./notice-502f1323.js";import{d as P,b as g,z as C,j as Q,r as s,o as b,e as I,f as r,k as a,s as c,I as R,x as W,g as l,m as d,p as X,h as Y}from"./index-f6b5f6b4.js";import{_ as Z}from"./_plugin-vue_export-helper-c27b6911.js";const ee=p=>(X("data-v-119c687c"),p=p(),Y(),p),te={class:"page-view"},oe={class:"table-operations"},ne={key:0},ae=["onClick"],le=ee(()=>r("a",{href:"#"},"删除",-1)),se=P({__name:"notice",setup(p){const S=g([{title:"序号",dataIndex:"index",key:"index",align:"center"},{title:"标题",dataIndex:"title",key:"title",align:"center"},{title:"内容",dataIndex:"content",key:"content",align:"center",customRender:({text:e,record:t,index:m,column:v})=>(e==null?void 0:e.substring(0,20))+"..."},{title:"操作",dataIndex:"action",key:"operation",align:"center",fixed:"right",width:140}]),n=g({noticeList:[],loading:!1,keyword:"",selectedRowKeys:[],pageSize:10,page:1}),o=g({visile:!1,editFlag:!1,title:"",form:{id:void 0,title:void 0},rules:{title:[{required:!0,message:"请输入",trigger:"change"}]}}),f=C();Q(()=>{_()});const _=()=>{n.loading=!0,G({keyword:n.keyword}).then(e=>{n.loading=!1,console.log(e),e.data.forEach((t,m)=>{t.index=m+1}),n.noticeList=e.data,n.loading=!1}).catch(e=>{n.loading=!1,console.log(e)})},z=C({onChange:(e,t)=>{console.log(`selectedRowKeys: ${e}`,"selectedRows: ",t),n.selectedRowKeys=e}}),K=()=>{h(),o.visile=!0,o.editFlag=!1,o.title="新增";for(const e in o.form)o.form[e]=void 0},A=e=>{h(),o.visile=!0,o.editFlag=!0,o.title="编辑";for(const t in o.form)o.form[t]=void 0;for(const t in e)o.form[t]=e[t]},F=e=>{console.log("delete",e),x({ids:e.id}).then(t=>{_()}).catch(t=>{d.error(t.msg||"操作失败")})},B=()=>{if(console.log(n.selectedRowKeys),n.selectedRowKeys.length<=0){console.log("hello"),d.warn("请勾选删除项");return}x({ids:n.selectedRowKeys.join(",")}).then(e=>{d.success("删除成功"),n.selectedRowKeys=[],_()}).catch(e=>{d.error(e.msg||"操作失败")})},L=()=>{var e;(e=f.value)==null||e.validate().then(()=>{o.editFlag?H(o.form).then(t=>{u(),_()}).catch(t=>{console.log(t),d.error(t.msg||"操作失败")}):J(o.form).then(t=>{u(),_()}).catch(t=>{console.log(t),d.error(t.msg||"操作失败")})}).catch(t=>{console.log("不能为空")})},N=()=>{u()},h=()=>{var e;(e=f.value)==null||e.resetFields()},u=()=>{o.visile=!1};return(e,t)=>{const m=s("a-button"),v=s("a-space"),V=s("a-divider"),$=s("a-popconfirm"),D=s("a-table"),E=s("a-input"),y=s("a-form-item"),w=s("a-col"),M=s("a-textarea"),j=s("a-row"),O=s("a-form"),T=s("a-modal");return b(),I("div",null,[r("div",te,[r("div",oe,[a(v,null,{default:c(()=>[a(m,{type:"primary",onClick:K},{default:c(()=>[R("新增")]),_:1}),a(m,{onClick:B},{default:c(()=>[R("批量删除")]),_:1})]),_:1})]),a(D,{size:"middle",rowKey:"id",loading:l(n).loading,columns:l(S),"data-source":l(n).noticeList,scroll:{x:"max-content"},"row-selection":l(z),pagination:{size:"default",current:l(n).page,pageSize:l(n).pageSize,onChange:i=>l(n).page=i,showSizeChanger:!1,showTotal:i=>`共${i}条数据`}},{bodyCell:c(({text:i,record:k,index:ce,column:U})=>[U.key==="operation"?(b(),I("span",ne,[r("a",{onClick:q=>A(k)},"编辑",8,ae),a(V,{type:"vertical"}),a($,{title:"确定删除?","ok-text":"是","cancel-text":"否",onConfirm:q=>F(k)},{default:c(()=>[le]),_:2},1032,["onConfirm"])])):W("",!0)]),_:1},8,["loading","columns","data-source","row-selection","pagination"])]),r("div",null,[a(T,{visible:l(o).visile,forceRender:!0,title:l(o).title,"ok-text":"确认","cancel-text":"取消",onCancel:N,onOk:L},{default:c(()=>[r("div",null,[a(O,{ref_key:"myform",ref:f,"label-col":{style:{width:"80px"}},model:l(o).form,rules:l(o).rules},{default:c(()=>[a(j,{gutter:24},{default:c(()=>[a(w,{span:"24"},{default:c(()=>[a(y,{label:"标题",name:"title"},{default:c(()=>[a(E,{placeholder:"请输入标题",value:l(o).form.title,"onUpdate:value":t[0]||(t[0]=i=>l(o).form.title=i)},null,8,["value"])]),_:1})]),_:1}),a(w,{span:"24"},{default:c(()=>[a(y,{label:"通知内容",name:"content"},{default:c(()=>[a(M,{placeholder:"请输入内容",rows:4,value:l(o).form.content,"onUpdate:value":t[1]||(t[1]=i=>l(o).form.content=i)},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["visible","title"])])])}}});const _e=Z(se,[["__scopeId","data-v-119c687c"]]);export{_e as default};
